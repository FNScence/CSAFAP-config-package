// Rapid fire and better follow recoil config
// ⚠️ Launch option required:   -testscript "../../csgo/cfg/CSAFAP/addons/.vtest"
//    This is also required:    bind "mouse1" "+M1"

// Follow recoil indicator (feel free to adjust here)
alias crosshair_follow "cl_crosshairsize 0.8; cl_crosshairthickness 1; cl_crosshairgap -5; cl_crosshaircolor 1;cl_crosshair_drawoutline false;cl_crosshairalpha 255;cl_crosshairstyle 4;cl_crosshairusealpha true"

// Base Setup
snd_toolvolume 0.05
alias +M1 "alias M1! tick_master; init_loops; alias M1> -attack; +M1_logic"
alias -M1 "alias M1! ""; cl_crosshair_recoil 0; reset_crosshair; alias M1>; -attack; spec_next"

// Follow-Recoil Logic (Clock Divider + Flicker Loop)

// 8-Step Delay (Clock Divider)
alias d_1 "alias run_recoil d_2"
alias d_2 "alias run_recoil d_3"
alias d_3 "alias run_recoil d_4"
alias d_4 "alias run_recoil d_5"
alias d_5 "alias run_recoil d_6"
alias d_6 "alias run_recoil d_7"
alias d_7 "alias run_recoil d_8"
alias d_8 "counter_step; alias run_recoil d_1" 

// Warmup Phase (Steps 1-7)
// Counts silently before the recoil starts
alias rc_01 "alias counter_step rc_02"
alias rc_02 "alias counter_step rc_03"
alias rc_03 "alias counter_step rc_04"
alias rc_04 "alias counter_step rc_05"
alias rc_05 "alias counter_step rc_06"
alias rc_06 "alias counter_step rc_07"
alias rc_07 "alias counter_step rc_loop_on" // Jump to Loop

// Infinite Flicker Loop (Follow Recoil indicator)
// Toggles Recoil & Crosshair Style back and forth forever
alias rc_loop_on  "cl_crosshair_recoil 1; crosshair_follow; alias counter_step rc_loop_off"
alias rc_loop_off "cl_crosshair_recoil 0; reset_crosshair;  alias counter_step rc_loop_on"

// Rapid Fire Logic (18-Step Loop)
alias rf_01 "+attack; alias run_fire rf_02"
alias rf_02 "-attack; alias run_fire rf_03"
alias rf_03 "alias run_fire rf_04"
alias rf_04 "alias run_fire rf_05"
alias rf_05 "alias run_fire rf_06"
alias rf_06 "alias run_fire rf_07"
alias rf_07 "alias run_fire rf_08"
alias rf_08 "alias run_fire rf_09"
alias rf_09 "alias run_fire rf_10"
alias rf_10 "alias run_fire rf_11"
alias rf_11 "alias run_fire rf_12"
alias rf_12 "alias run_fire rf_13"
alias rf_13 "alias run_fire rf_14"
alias rf_14 "alias run_fire rf_15"
alias rf_15 "alias run_fire rf_16"
alias rf_16 "alias run_fire rf_17"
alias rf_17 "alias run_fire rf_18"
alias rf_18 "alias run_fire rf_01" 

// Dynamic Mode Switcher
// Option A: Rapid Fire ONLY (No Recoil Logic)
alias state_rapid_only "alias tick_master run_fire; alias +M1_logic ""; alias init_loops alias run_fire rf_01; play buttons/blip2; alias toggle_rapid rapid_mode_off; echo [STATE: RAPID_FIRE_ONLY]"

// Option B: ALL ON (Rapid Fire + Recoil Flicker)
alias state_all_on "alias tick_master tick_on; alias +M1_logic ""; alias init_loops reset_on; play buttons/blip2; alias toggle_rapid rapid_mode_off; echo [STATE: ALL_FEATURES_ON]"
alias tick_on "run_recoil; run_fire"
alias reset_on "alias run_recoil d_1; alias counter_step rc_01; alias run_fire rf_01"

// Universal OFF State
alias rapid_mode_off "alias tick_master ""; alias +M1_logic +attack; alias init_loops ""; play buttons/blip1; alias toggle_rapid current_on_mode; echo [STATE: OFF]"

// Setup 1: Toggle switches between Rapid-Only and Off
alias rapid_setup_1 "alias current_on_mode state_rapid_only; rapid_mode_off; echo [SETUP_1_SELECTED]"

// Setup 2: Toggle switches between All-Features and Off
alias rapid_setup_2 "alias current_on_mode state_all_on; rapid_mode_off; echo [SETUP_2_SELECTED]; exec CSAFAP/movement/"

// Initialization
alias current_on_mode state_rapid_only; alias tick_master run_fire; alias +M1_logic ""; alias init_loops alias run_fire rf_01; alias toggle_rapid rapid_mode_off
alias tick_master ""; alias +M1_logic +attack; alias init_loops ""; alias toggle_rapid current_on_mode
exec csafap/movement/follow_off

// Toggle Bind (already set in CSAFAP/main.cfg)
//bind "CAPSLOCK" "toggle_rapid"